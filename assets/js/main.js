// Complete Multi-language Support for EventsGuide
const translations = {
    en: {
        // Navigation
        "nav.home": "Home",
        "nav.events": "Events",
        "nav.about": "About",
        "nav.contact": "Contact",
        
        // Home page
        "home.hero.title1": "Discover Amazing Events in Your City",
        "home.hero.desc1": "Find the best local events, concerts, workshops, and activities happening around you.",
        "home.hero.button1": "Explore Events",
        "home.hero.title2": "Join Cultural Experiences",
        "home.hero.desc2": "Immerse yourself in art exhibitions, theater performances, and cultural festivals that enrich your community.",
        "home.hero.button2": "View Culture Events",
        "home.hero.title3": "Stay Active & Healthy",
        "home.hero.desc3": "Participate in sports events, marathons, and fitness activities that keep you moving and connected.",
        "home.hero.button3": "Find Sports Events",
        "home.top_events": "Top Events This Week",
        "home.categories": "Browse by Category",
        "home.latest_events": "Latest Events",
        "home.view_all_events": "View All Events",
        "home.view_details": "View Details",
        
        // Categories
        "category.music": "Music",
        "category.culture": "Culture",
        "category.sports": "Sports",
        "category.family": "Family",
        "category.food": "Food",
        "category.business": "Business",
        
        // About page
        "about.title": "About EventsGuide",
        "about.subtitle": "Connecting communities through amazing local events",
        "about.mission.title": "Our Mission",
        "about.mission.lead": "At EventsGuide, we believe that every community deserves access to amazing local events and experiences.",
        "about.mission.desc1": "Our platform serves as the ultimate bridge between event organizers and community members, making it easier than ever to discover, share, and attend local events that matter to you.",
        "about.mission.desc2": "Whether you're looking for cultural experiences, sports events, family activities, or networking opportunities, EventsGuide is your trusted companion for exploring what your city has to offer.",
        "about.vision.title": "Our Vision",
        "about.vision.lead": "To create vibrant, connected communities where every event brings people together.",
        "about.vision.desc": "We envision a world where local events thrive, communities are more connected, and everyone has access to enriching experiences right in their neighborhood.",
        "about.vision.community": "Community First",
        "about.vision.community_sub": "Building stronger communities",
        "about.vision.passion": "Passion Driven",
        "about.vision.passion_sub": "Celebrating local culture",
        "about.team": "Meet Our Team",
        "about.raghed": "Raghad Nassar",
        "about.raghed_role": "HTML & CSS Developer",
        "about.mohammed": "Mohammed Al Bitar",
        "about.mohammed_role": "JS Developer",
        "about.lama": "Lama Saies",
        "about.lama_role": "HTML & CSS Developer",
        "about.values": "Our Values & Standards",
        "about.values.quality": "Quality Assurance",
        "about.values.quality_desc": "We carefully curate events to ensure they meet our high standards for safety, authenticity, and community value.",
        "about.values.partnership": "Community Partnership",
        "about.values.partnership_desc": "We work closely with local organizers, venues, and community leaders to support events that matter most.",
        "about.values.sustainable": "Sustainable Events",
        "about.values.sustainable_desc": "We promote environmentally conscious events and encourage sustainable practices among organizers.",
        
        // Contact page
        "contact.title": "Contact Us",
        "contact.subtitle": "We'd love to hear from you. Get in touch with our team!",
        "contact.form.title": "Send us a Message",
        "contact.form.first_name": "First Name *",
        "contact.form.last_name": "Last Name *",
        "contact.form.email": "Email Address *",
        "contact.form.subject": "Subject *",
        "contact.form.subject_placeholder": "Choose a subject...",
        "contact.form.general": "General Inquiry",
        "contact.form.event": "Event Submission",
        "contact.form.technical": "Technical Support",
        "contact.form.partnership": "Partnership",
        "contact.form.other": "Other",
        "contact.form.message": "Message *",
        "contact.form.message_placeholder": "Tell us how we can help you...",
        "contact.form.send": "Send Message",
        "contact.info.title": "Get in Touch",
        "contact.info.address": "Address",
        "contact.info.phone": "Phone",
        "contact.info.email": "Email",
        "contact.info.hours": "Business Hours",
        "contact.social.title": "Follow Us",
        "contact.social.facebook": "Facebook",
        "contact.social.twitter": "Twitter",
        "contact.social.instagram": "Instagram",
        "contact.social.linkedin": "LinkedIn",
        
        // Events page
        "events.title": "All Events",
        "events.subtitle": "Discover all the exciting events happening in your city",
        "events.search_placeholder": "Search events...",
        "events.category_all": "All Categories",
        "events.category_music": "Music",
        "events.category_culture": "Culture",
        "events.category_sports": "Sports",
        "events.category_family": "Family",
        "events.category_food": "Food",
        "events.category_business": "Business",
        "events.clear_filters": "Clear",
        "events.no_events": "No events found",
        "events.no_events_desc": "Try adjusting your search or filter criteria.",
        
        // Event details
        "event.gallery": "Event Gallery",
        "event.about": "About This Event",
        "event.info": "Event Information",
        "event.date": "Date",
        "event.location": "Location",
        "event.price": "Price",
        "event.organizer": "Organizer",
        "event.website": "Website",
        "event.add_calendar": "Add to Calendar",
        "event.share": "Share Event",
        "event.related": "Related Events",
        
        // Footer
        "footer.description": "Your ultimate guide to discovering amazing local events and activities in your city.",
        "footer.contact_info": "Contact Info",
        "footer.follow_us": "Follow Us",
        "footer.copyright": "© 2025 EventsGuide. All rights reserved.",
             
        // General
        "general.at": "at"
    },
    ar: {
        // Navigation
        "nav.home": "الرئيسية",
        "nav.events": "الفعاليات",
        "nav.about": "من نحن",
        "nav.contact": "اتصل بنا",
        
        // Home page
        "home.hero.title1": "اكتشف الفعاليات المميزة في مدينتك",
        "home.hero.desc1": "ابحث عن أفضل الفعاليات المحلية والحفلات وورش العمل والأنشطة التي تقام حولك.",
        "home.hero.button1": "استكشف الفعاليات",
        "home.hero.title2": "انضم للتجارب الثقافية",
        "home.hero.desc2": "انغمس في المعارض الفنية والعروض المسرحية والمهرجانات الثقافية التي تثري مجتمعك.",
        "home.hero.button2": "عرض الفعاليات الثقافية",
        "home.hero.title3": "ابق نشطًا وصحيًا",
        "home.hero.desc3": "شارك في الفعاليات الرياضية والماراثونات والأنشطة البدنية التي تبقي متحركًا ومتواصلاً.",
        "home.hero.button3": "ابحث عن الفعاليات الرياضية",
        "home.top_events": "أهم الفعاليات هذا الأسبوع",
        "home.categories": "تصفح حسب التصنيف",
        "home.latest_events": "أحدث الفعاليات",
        "home.view_all_events": "عرض جميع الفعاليات",
        "home.view_details": "عرض التفاصيل",
        
        // Categories
        "category.music": "موسيقى",
        "category.culture": "ثقافة",
        "category.sports": "رياضة",
        "category.family": "عائلة",
        "category.food": "طعام",
        "category.business": "أعمال",
        
        // About page
        "about.title": "عن EventsGuide",
        "about.subtitle": "ربط المجتمعات من خلال الفعاليات المحلية المميزة",
        "about.mission.title": "مهمتنا",
        "about.mission.lead": "في EventsGuide، نؤمن بأن كل مجتمع يستحق الوصول إلى الفعاليات والتجارب المحلية المميزة.",
        "about.mission.desc1": "تعمل منصتنا كجسر مثالي بين منظمي الفعاليات وأفراد المجتمع، مما يسهل اكتشاف ومشاركة وحضور الفعاليات المحلية التي تهمك.",
        "about.mission.desc2": "سواء كنت تبحث عن تجارب ثقافية أو فعاليات رياضية أو أنشطة عائلية أو فرص للتواصل، فإن EventsGuide هو رفيقك الموثوق لاكتشاف ما تقدمه مدينتك.",
        "about.vision.title": "رؤيتنا",
        "about.vision.lead": "لخلق مجتمعات نابضة بالحياة ومتصلة حيث تجمع كل فعالية الناس معًا.",
        "about.vision.desc": "نتصور عالمًا تزدهر فيه الفعاليات المحلية، وتكون المجتمعات أكثر اتصالاً، ويتمتع الجميع بإمكانية الوصول إلى تجارب ثرية في منطقتهم.",
        "about.vision.community": "المجتمع أولاً",
        "about.vision.community_sub": "بناء مجتمعات أقوى",
        "about.vision.passion": "مدفوع بالشغف",
        "about.vision.passion_sub": "الاحتفاء بالثقافة المحلية",
        "about.team": "تعرف على فريقنا",
        "about.raghed": "رغد نصار",
        "about.raghed_role": "مطور HTML & CSS",
        "about.mohammed": "محمد البيطار",
        "about.mohammed_role": "مطور JavaScript",
        "about.lama": "لمى السايس",
        "about.lama_role": "مطور HTML & CSS",
        "about.values": "قيمنا ومعاييرنا",
        "about.values.quality": "ضمان الجودة",
        "about.values.quality_desc": "نقوم باختيار الفعاليات بعناية لضمان استيفائها لمعاييرنا العالية للسلامة والأصالة والقيمة المجتمعية.",
        "about.values.partnership": "الشراكة المجتمعية",
        "about.values.partnership_desc": "نعمل بشكل وثيق مع المنظمين المحليين والأماكن وقادة المجتمع لدعم الفعاليات الأكثر أهمية.",
        "about.values.sustainable": "فعاليات مستدامة",
        "about.values.sustainable_desc": "نروج للفعاليات الواعية بيئياً ونشجع الممارسات المستدامة بين المنظمين.",
        
        // Contact page
        "contact.title": "اتصل بنا",
        "contact.subtitle": "نود أن نسمع منك. تواصل مع فريقنا!",
        "contact.form.title": "أرسل لنا رسالة",
        "contact.form.first_name": "الاسم الأول *",
        "contact.form.last_name": "اسم العائلة *",
        "contact.form.email": "البريد الإلكتروني *",
        "contact.form.subject": "الموضوع *",
        "contact.form.subject_placeholder": "اختر موضوعًا...",
        "contact.form.general": "استفسار عام",
        "contact.form.event": "إرسال فعالية",
        "contact.form.technical": "الدعم الفني",
        "contact.form.partnership": "شراكة",
        "contact.form.other": "أخرى",
        "contact.form.message": "الرسالة *",
        "contact.form.message_placeholder": "أخبرنا كيف يمكننا مساعدتك...",
        "contact.form.send": "إرسال الرسالة",
        "contact.info.title": "ابق على اتصال",
        "contact.info.address": "العنوان",
        "contact.info.phone": "الهاتف",
        "contact.info.email": "البريد الإلكتروني",
        "contact.info.hours": "ساعات العمل",
        "contact.social.title": "تابعنا",
        "contact.social.facebook": "فيسبوك",
        "contact.social.twitter": "تويتر",
        "contact.social.instagram": "انستغرام",
        "contact.social.linkedin": "لينكدإن",
        
        // Events page
        "events.title": "جميع الفعاليات",
        "events.subtitle": "اكتشف جميع الفعاليات المثيرة التي تقام في مدينتك",
        "events.search_placeholder": "ابحث في الفعاليات...",
        "events.category_all": "جميع التصنيفات",
        "events.category_music": "موسيقى",
        "events.category_culture": "ثقافة",
        "events.category_sports": "رياضة",
        "events.category_family": "عائلة",
        "events.category_food": "طعام",
        "events.category_business": "أعمال",
        "events.clear_filters": "مسح",
        "events.no_events": "لم يتم العثور على فعاليات",
        "events.no_events_desc": "حاول تعديل معايير البحث أو التصفية.",
        
        // Event details
        "event.gallery": "معرض الصور",
        "event.about": "عن هذه الفعالية",
        "event.info": "معلومات الفعالية",
        "event.date": "التاريخ",
        "event.location": "الموقع",
        "event.price": "السعر",
        "event.organizer": "المنظم",
        "event.website": "الموقع الإلكتروني",
        "event.add_calendar": "إضافة إلى التقويم",
        "event.share": "مشاركة الفعالية",
        "event.related": "فعاليات ذات صلة",
        
        // Footer
        "footer.description": "دليلك المثالي لاكتشاف الفعاليات والأنشطة المحلية المميزة في مدينتك.",
        "footer.contact_info": "معلومات الاتصال",
        "footer.follow_us": "تابعنا",
        "footer.copyright": "© 2025 EventsGuide. جميع الحقوق محفوظة.",

        // General
        "general.at": "في"
    }
};
// Current language
let currentLanguage = 'en';

// Language functions
function changeLanguage(lang) {
    const flag = document.getElementById("flag");
    if (lang == "ar") {
        flag.className = "fi fi-sy";
    } else {
        flag.className = "fi fi-us";
    }
    console.log('Changing language to:', lang);
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    applyLanguage();
    updatePageDirection();
    updateDynamicContent();
    location.reload();
}
function applyLanguage() {
    // Update all elements with data-i18n attribute
     document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    });

    // Update placeholder attributes
       document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
            element.placeholder = translations[currentLanguage][key];
        }
    });


    // Update language switcher
      const currentLanguageElement = document.getElementById('currentLanguage');
    if (currentLanguageElement) {
        currentLanguageElement.textContent = currentLanguage.toUpperCase();
    }

    // Update form elements
    updateFormElements();
}

function updatePageDirection() {
    if (currentLanguage === 'ar') {
        document.documentElement.setAttribute('dir', 'rtl');
        document.body.classList.add('arabic-font');
    } else {
        document.documentElement.setAttribute('dir', 'ltr');
        document.body.classList.remove('arabic-font');
    }
}

function updateFormElements() {
    // Update events page filters
    const categoryFilter = document.getElementById('categoryFilter');
    if (categoryFilter) {
        const options = categoryFilter.querySelectorAll('option');
        if (options.length >= 7) {
            options[0].textContent = translations[currentLanguage]['events.category_all'];
            options[1].textContent = translations[currentLanguage]['events.category_music'];
            options[2].textContent = translations[currentLanguage]['events.category_culture'];
            options[3].textContent = translations[currentLanguage]['events.category_sports'];
            options[4].textContent = translations[currentLanguage]['events.category_family'];
            options[5].textContent = translations[currentLanguage]['events.category_food'];
            options[6].textContent = translations[currentLanguage]['events.category_business'];
        }
    }

    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.placeholder = translations[currentLanguage]['events.search_placeholder'];
    }

    const clearFilters = document.getElementById('clearFilters');
    if (clearFilters) {
        clearFilters.textContent = translations[currentLanguage]['events.clear_filters'];
    }

    // Update contact form
    const contactForm = document.getElementById('contactForm');
    if (contactForm) {
        // Update labels
        const labels = contactForm.querySelectorAll('label');
        labels.forEach(label => {
            const forAttr = label.getAttribute('for');
            if (forAttr === 'firstName') {
                label.textContent = translations[currentLanguage]['contact.form.first_name'];
            } else if (forAttr === 'lastName') {
                label.textContent = translations[currentLanguage]['contact.form.last_name'];
            } else if (forAttr === 'email') {
                label.textContent = translations[currentLanguage]['contact.form.email'];
            } else if (forAttr === 'subject') {
                label.textContent = translations[currentLanguage]['contact.form.subject'];
            } else if (forAttr === 'message') {
                label.textContent = translations[currentLanguage]['contact.form.message'];
            }
        });

        // Update subject options
        const subjectSelect = document.getElementById('subject');
        if (subjectSelect) {
            const options = subjectSelect.querySelectorAll('option');
            if (options.length >= 6) {
                options[0].textContent = translations[currentLanguage]['contact.form.subject_placeholder'];
                options[1].textContent = translations[currentLanguage]['contact.form.general'];
                options[2].textContent = translations[currentLanguage]['contact.form.event'];
                options[3].textContent = translations[currentLanguage]['contact.form.technical'];
                options[4].textContent = translations[currentLanguage]['contact.form.partnership'];
                options[5].textContent = translations[currentLanguage]['contact.form.other'];
            }
        }

        // Update message placeholder
        const messageTextarea = document.getElementById('message');
        if (messageTextarea) {
            messageTextarea.placeholder = translations[currentLanguage]['contact.form.message_placeholder'];
        }

        // Update submit button
        const submitButton = contactForm.querySelector('button[type="submit"]');
        if (submitButton) {
            const icon = submitButton.querySelector('i');
            submitButton.innerHTML = `<i class="${icon.className} me-2"></i>${translations[currentLanguage]['contact.form.send']}`;
        }
    }
}
function updateDynamicContent() {
    console.log('Updating dynamic content for language:', currentLanguage);
    
    // Get current page
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    console.log('Current page:', currentPage);
    
    // Update hero carousel if exists
    if (document.getElementById('heroCarousel')) {
        console.log('Reloading hero carousel');
        loadHeroCarousel();
    }
    
    // Update categories if exists
    if (document.getElementById('categoriesContainer')) {
        console.log('Reloading categories');
        loadCategories();
    }
    
    // Update events based on current page
    if (window.eventsData && window.eventsData.length > 0) {
        console.log('Events data found, updating events for page:', currentPage);
        
        switch (currentPage) {
            case 'index.html':
            case '':
                if (document.getElementById('eventsCarousel')) {
                    console.log('Reloading top events carousel');
                    loadTopEventsCarousel();
                }
                if (document.getElementById('latestEvents')) {
                    console.log('Reloading latest events');
                    loadLatestEvents();
                }
                break;
            case 'events.html':
                if (document.getElementById('eventsContainer')) {
                    console.log('Reloading all events');
                    loadAllEvents();
                }
                break;
            case 'event.html':
                if (currentEvent && document.getElementById('eventHeader')) {
                    console.log('Reloading event details');
                    renderEventDetails(currentEvent);
                    loadRelatedEvents(currentEvent);
                } else {
                    // Try to load event details from URL
                    console.log('No current event, trying to load from URL');
                    initializeEventDetailsPage();
                }
                break;
        }
    } else {
        console.log('No events data found');
    }

    // Re-apply language to any newly created elements
    setTimeout(() => {
        applyLanguage();
    }, 100);
}

// Initialize language
function initializeLanguage() {
    // Check for language in URL first, then localStorage, then default to 'en'
    const urlParams = new URLSearchParams(window.location.search);
    const urlLang = urlParams.get('lang');
    
    if (urlLang && (urlLang === 'en' || urlLang === 'ar')) {
        console.log('Language from URL:', urlLang);
        currentLanguage = urlLang;
        localStorage.setItem('language', urlLang);
    } else {
        const savedLanguage = localStorage.getItem('language') || 'en';
        currentLanguage = savedLanguage;
    }
    
    // Initialize flag based on current language
    const flag = document.getElementById("flag");
    if (flag) {
        if (currentLanguage === 'ar') {
            flag.className = "fi fi-sy";
        } else {
            flag.className = "fi fi-us";
        }
    }
    
    applyLanguage();
    updatePageDirection();
    
    // Add event listeners to language options
    document.querySelectorAll('.language-option').forEach(option => {
        option.addEventListener('click', function(e) {
            e.preventDefault();
            const lang = this.getAttribute('data-lang');
            changeLanguage(lang);
        });
    });
}

// Hero slides data with multi-language support
const heroSlides = [
    {
        title: {
            en: "Discover Amazing Events in Your City",
            ar: "اكتشف الفعاليات المميزة في مدينتك"
        },
        description: {
            en: "Find the best local events, concerts, workshops, and activities happening around you.",
            ar: "ابحث عن أفضل الفعاليات المحلية والحفلات وورش العمل والأنشطة التي تقام حولك."
        },
        buttonText: {
            en: "Explore Events",
            ar: "استكشف الفعاليات"
        },
        buttonLink: "events.html",
        image: "https://images.pexels.com/photos/1190298/pexels-photo-1190298.jpeg",
        alt: {
            en: "Community Events",
            ar: "فعاليات المجتمع"
        }
    },
    {
        title: {
            en: "Join Cultural Experiences",
            ar: "انضم للتجارب الثقافية"
        },
        description: {
            en: "Immerse yourself in art exhibitions, theater performances, and cultural festivals that enrich your community.",
            ar: "انغمس في المعارض الفنية والعروض المسرحية والمهرجانات الثقافية التي تثري مجتمعك."
        },
        buttonText: {
            en: "View Culture Events",
            ar: "عرض الفعاليات الثقافية"
        },
        buttonLink: "events.html?category=culture",
        image: "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg",
        alt: {
            en: "Cultural Events",
            ar: "فعاليات ثقافية"
        }
    },
    {
        title: {
            en: "Stay Active & Healthy",
            ar: "ابق نشطًا وصحيًا"
        },
        description: {
            en: "Participate in sports events, marathons, and fitness activities that keep you moving and connected.",
            ar: "شارك في الفعاليات الرياضية والماراثونات والأنشطة البدنية التي تبقي متحركًا ومتواصلاً."
        },
        buttonText: {
            en: "Find Sports Events",
            ar: "ابحث عن الفعاليات الرياضية"
        },
        buttonLink: "events.html?category=sports",
        image: "https://images.pexels.com/photos/2526878/pexels-photo-2526878.jpeg",
        alt: {
            en: "Sports Events",
            ar: "فعاليات رياضية"
        }
    }
];

// Categories data with multi-language support
const categories = [
    {
        name: {
            en: "Music",
            ar: "موسيقى"
        },
        icon: "fas fa-music",
        link: "events.html?category=music"
    },
    {
        name: {
            en: "Culture",
            ar: "ثقافة"
        },
        icon: "fas fa-theater-masks",
        link: "events.html?category=culture"
    },
    {
        name: {
            en: "Sports",
            ar: "رياضة"
        },
        icon: "fas fa-football-ball",
        link: "events.html?category=sports"
    },
    {
        name: {
            en: "Family",
            ar: "عائلة"
        },
        icon: "fas fa-users",
        link: "events.html?category=family"
    },
    {
        name: {
            en: "Food",
            ar: "طعام"
        },
        icon: "fas fa-utensils",
        link: "events.html?category=food"
    },
    {
        name: {
            en: "Business",
            ar: "أعمال"
        },
        icon: "fas fa-briefcase",
        link: "events.html?category=business"
    }
];

// Sample events data with multi-language support
const eventsData = [
    {
        id: 1,
        title: {
            en: "Summer Jazz Festival",
            ar: "مهرجان الجاز الصيفي"
        },
        category: "music",
        date: "2024-12-25",
        time: "7:00 PM",
        location: {
            en: "Central Park",
            ar: "الحديقة المركزية"
        },
        image: "https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg",
        shortDescription: {
            en: "Experience the best jazz music in the city with renowned artists.",
            ar: "استمتع بأفضل موسيقى الجاز في المدينة مع فنانين معروفين."
        },
        fullDescription: {
            en: "Join us for an unforgettable evening of smooth jazz under the stars. This annual festival brings together world-class musicians for a celebration of jazz in all its forms. From traditional swing to contemporary fusion, experience the evolution of this incredible art form. Food trucks and local vendors will be available throughout the event.",
            ar: "انضم إلينا في أمسية لا تنسى لموسيقى الجاز السلسة تحت النجوم. يجمع هذا المهرجان السنوي موسيقيين من الطراز العالمي للاحتفال بموسيقى الجاز بجميع أشكالها. من السوينغ التقليدي إلى الفيوجن المعاصر، جرب تطور هذا الفن المذهل. ستتوفر شاحنات الطعام والبائعين المحليين طوال الحدث."
        },
        price: "Free",
        organizer: "City Music Society",
        website: "www.cityjazz.com",
        gallery: [
            "https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg",
            "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg",
            "https://images.pexels.com/photos/167636/pexels-photo-167636.jpeg"
        ]
    },
    {
        id: 2,
        title: {
            en: "Modern Art Exhibition",
            ar: "معرض الفن الحديث"
        },
        category: "culture",
        date: "2024-12-28",
        time: "10:00 AM",
        location: {
            en: "Downtown Art Gallery",
            ar: "معرض الفن في وسط المدينة"
        },
        image: "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg",
        shortDescription: {
            en: "Discover contemporary art from local and international artists.",
            ar: "اكتشف الفن المعاصر من فنانين محليين ودوليين."
        },
        fullDescription: {
            en: "Immerse yourself in the world of contemporary art at our flagship exhibition. Featuring works from emerging and established artists, this exhibition explores themes of identity, technology, and human connection. Interactive installations and guided tours available daily.",
            ar: "انغمس في عالم الفن المعاصر في معرضنا الرئيسي. يضم المعرض أعمالاً لفنانين ناشئين ومعروفين، ويستكشف موضوعات الهوية والتكنولوجيا والاتصال الإنساني. تتوفر تركيب تفاعلية وجولات إرشادية يومياً."
        },
        price: "$15",
        organizer: "Modern Art Collective",
        website: "www.modernartgallery.com",
        gallery: [
            "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg",
            "https://images.pexels.com/photos/1743227/pexels-photo-1743227.jpeg",
            "https://images.pexels.com/photos/1183992/pexels-photo-1183992.jpeg"
        ]
    },
    {
        id: 3,
        title: {
            en: "International Food Festival",
            ar: "مهرجان الطعام الدولي"
        },
        category: "food",
        date: "2025-01-02",
        time: "11:00 AM",
        location: {
            en: "Downtown Plaza",
            ar: "ساحة وسط المدينة"
        },
        image: "https://images.pexels.com/photos/3171837/pexels-photo-3171837.jpeg",
        shortDescription: {
            en: "Taste cuisines from around the world in one amazing location.",
            ar: "تذوق المأكولات من حول العالم في مكان واحد مذهل."
        },
        fullDescription: {
            en: "Embark on a culinary journey around the globe without leaving the city. Our International Food Festival features authentic dishes from over 20 countries, prepared by local chefs and immigrant communities. Live cooking demonstrations, cultural performances, and family activities make this a perfect day out for food lovers.",
            ar: "انطلق في رحلة طهي حول العالم دون مغادرة المدينة. يقدم مهرجاننا الدولي للطعام أطباقاً أصلية من أكثر من 20 دولة، يحضرها طهاة محليون ومجتمعات مهاجرة. عروض طهي حية وعروض ثقافية وأنشطة عائلية تجعل هذا اليوم مثالياً لعشاق الطعام."
        },
        price: "Free Entry",
        organizer: "Cultural Food Alliance",
        website: "www.foodfestival.org",
        gallery: [
            "https://images.pexels.com/photos/3171837/pexels-photo-3171837.jpeg",
            "https://images.pexels.com/photos/1640777/pexels-photo-1640777.jpeg",
            "https://images.pexels.com/photos/958545/pexels-photo-958545.jpeg"
        ]
    },
    {
        id: 4,
        title: {
            en: "City Marathon 2025",
            ar: "ماراثون المدينة 2025"
        },
        category: "sports",
        date: "2025-01-05",
        time: "6:00 AM",
        location: {
            en: "City Center",
            ar: "وسط المدينة"
        },
        image: "https://images.pexels.com/photos/2526878/pexels-photo-2526878.jpeg",
        shortDescription: {
            en: "Annual city marathon with routes for all skill levels.",
            ar: "ماراثون المدينة السنوي بمسارات لجميع المستويات."
        },
        fullDescription: {
            en: "Challenge yourself in our annual city marathon! Choose from full marathon, half marathon, 10K, or 5K routes. All participants receive a finisher's medal and t-shirt. Water stations every mile, medical support, and post-race celebration with live music and food vendors.",
            ar: "تحدى نفسك في ماراثون المدينة السنوي! اختر من بين مسارات الماراثون الكامل أو النصف أو 10 كيلومتر أو 5 كيلومترات. جميع المشاركين يتلقون ميدالية إنهاء وقميص. محطات مياه كل ميل ودعم طبي واحتفال بعد السباق مع موسيقى حية وبائعي طعام."
        },
        price: "$45-85",
        organizer: "City Running Club",
        website: "www.citymarathon.com",
        gallery: [
            "https://images.pexels.com/photos/2526878/pexels-photo-2526878.jpeg",
            "https://images.pexels.com/photos/3764984/pexels-photo-3764984.jpeg",
            "https://images.pexels.com/photos/2402777/pexels-photo-2402777.jpeg"
        ]
    },
    {
        id: 5,
        title: {
            en: "Family Fun Day",
            ar: "يوم المرح العائلي"
        },
        category: "family",
        date: "2025-01-08",
        time: "1:00 PM",
        location: {
            en: "Riverside Park",
            ar: "حديقة Riverside"
        },
        image: "https://images.pexels.com/photos/1497394/pexels-photo-1497394.jpeg",
        shortDescription: {
            en: "A day full of activities and entertainment for the whole family.",
            ar: "يوم مليء بالأنشطة والترفيه للعائلة بأكملها."
        },
        fullDescription: {
            en: "Bring the whole family for a day of fun and activities! Face painting, bouncy castles, games, live entertainment, and food stalls. Activities designed for all ages from toddlers to grandparents. Free admission with optional activity tickets available.",
            ar: "احضر العائلة بأكملها ليوم من المرح والأنشطة! رسم الوجوه، القلاع النطاطة، الألعاب، الترفيه الحي، وأكشاك الطعام. أنشطة مصممة لجميع الأعمار من الأطفال إلى الأجداد. دخول مجاني مع تذاكر أنشطة اختيارية متاحة."
        },
        price: "Free",
        organizer: "Parks & Recreation",
        website: "www.cityparks.gov",
        gallery: [
            "https://images.pexels.com/photos/1497394/pexels-photo-1497394.jpeg",
            "https://images.pexels.com/photos/1128318/pexels-photo-1128318.jpeg",
            "https://images.pexels.com/photos/1720186/pexels-photo-1720186.jpeg"
        ]
    },
    {
        id: 6,
        title: {
            en: "Tech Conference 2025",
            ar: "مؤتمر التكنولوجيا 2025"
        },
        category: "business",
        date: "2025-01-10",
        time: "9:00 AM",
        location: {
            en: "Convention Center",
            ar: "مركز المؤتمرات"
        },
        image: "https://images.pexels.com/photos/2774556/pexels-photo-2774556.jpeg",
        shortDescription: {
            en: "Annual technology conference featuring industry leaders and innovations.",
            ar: "مؤتمر التكنولوجيا السنوي يضم قادة الصناعة والابتكارات."
        },
        fullDescription: {
            en: "Join tech professionals, entrepreneurs, and innovators for a day of learning and networking. Keynote speakers from major tech companies, breakout sessions on AI, blockchain, and cybersecurity. Startup showcase and career fair included.",
            ar: "انضم لمحترفي التكنولوجيا، رواد الأعمال، والمبتكرين ليوم من التعلم والتواصل. متحدثون رئيسيون من شركات التكنولوجيا الكبرى، جلسات حول الذكاء الاصطناعي، البلوك تشين، والأمن السيبراني. يتضمن عرض الشركات الناشئة ومعرض وظائف."
        },
        price: "$199",
        organizer: "Tech Valley Association",
        website: "www.techconf.org",
        gallery: [
            "https://images.pexels.com/photos/2774556/pexels-photo-2774556.jpeg",
            "https://images.pexels.com/photos/1181533/pexels-photo-1181533.jpeg",
            "https://images.pexels.com/photos/3184360/pexels-photo-3184360.jpeg"
        ]
    },
    {
        id: 7,
        title: {
            en: "Rock Concert Night",
            ar: "ليلة حفل الروك"
        },
        category: "music",
        date: "2025-01-12",
        time: "8:00 PM",
        location: {
            en: "City Arena",
            ar: "ساحة المدينة"
        },
        image: "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg",
        shortDescription: {
            en: "High-energy rock concert featuring local and international bands.",
            ar: "حفل روك عالي الطاقة يضم فرق محلية ودولية."
        },
        fullDescription: {
            en: "Get ready to rock! This electrifying concert features three amazing bands performing their greatest hits and new material. From classic rock to modern alternative, this night promises non-stop energy and unforgettable performances. VIP packages include meet and greet opportunities.",
            ar: "استعد للروك! يضم هذا الحفل المثير ثلاث فرق مذهلة تؤدي أعظم أغانيها ومواد جديدة. من الروك الكلاسيكي إلى البديل الحديث، هذه الليلة تعد بطاقة لا تتوقف وعروض لا تنسى. تشمل باقات VIP فرص اللقاء والتقاط الصور."
        },
        price: "$35-75",
        organizer: "Rock City Productions",
        website: "www.rockcityproductions.com",
        gallery: [
            "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg",
            "https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg",
            "https://images.pexels.com/photos/167636/pexels-photo-167636.jpeg"
        ]
    },
    {
        id: 8,
        title: {
            en: "Photography Workshop",
            ar: "ورشة التصوير الفوتوغرافي"
        },
        category: "culture",
        date: "2025-01-15",
        time: "2:00 PM",
        location: {
            en: "Community Center",
            ar: "المركز المجتمعي"
        },
        image: "https://images.pexels.com/photos/1183992/pexels-photo-1183992.jpeg",
        shortDescription: {
            en: "Learn professional photography techniques from expert photographers.",
            ar: "تعلم تقنيات التصوير الفوتوغرافي المحترفة من مصورين خبراء."
        },
        fullDescription: {
            en: "Master the art of photography in this comprehensive workshop. Learn about composition, lighting, editing, and storytelling through images. Suitable for beginners and intermediate photographers. Bring your camera or smartphone - all equipment levels welcome.",
            ar: "أتقن فن التصوير الفوتوغرافي في هذه الورشة الشاملة. تعلم عن التكوين، الإضاءة، التحرير، وسرد القصص عبر الصور. مناسبة للمبتدئين والمصورين المتوسطين. أحضر كاميرتك أو هاتفك الذكي - جميع مستويات المعدات مرحب بها."
        },
        price: "$45",
        organizer: "Creative Arts Society",
        website: "www.creativeartssociety.org",
        gallery: [
            "https://images.pexels.com/photos/1183992/pexels-photo-1183992.jpeg",
            "https://images.pexels.com/photos/1743227/pexels-photo-1743227.jpeg",
            "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg"
        ]
    },
    {
        id: 9,
        title: {
            en: "Basketball Tournament",
            ar: "بطولة كرة السلة"
        },
        category: "sports",
        date: "2025-01-18",
        time: "10:00 AM",
        location: {
            en: "Sports Complex",
            ar: "المجمع الرياضي"
        },
        image: "https://images.pexels.com/photos/2402777/pexels-photo-2402777.jpeg",
        shortDescription: {
            en: "Annual community basketball tournament for all age groups.",
            ar: "بطولة كرة السلة المجتمعية السنوية لجميع الفئات العمرية."
        },
        fullDescription: {
            en: "Join the excitement of our annual basketball tournament! Categories for youth, adults, and seniors. Teams compete for trophies and prizes. Registration includes tournament t-shirt and refreshments. Spectators welcome - food trucks and entertainment throughout the day.",
            ar: "انضم للإثارة في بطولة كرة السلة السنوية! فئات للشباب، البالغين، وكبار السن. تتنافس الفرق على الكؤوس والجوائز. التسجيل يشمل قميص البطولة والمشروبات. المشجعون مرحب بهم - شاحنات الطعام والترفيه طوال اليوم."
        },
        price: "$25 per team",
        organizer: "City Sports League",
        website: "www.citysportsleague.com",
        gallery: [
            "https://images.pexels.com/photos/2402777/pexels-photo-2402777.jpeg",
            "https://images.pexels.com/photos/3764984/pexels-photo-3764984.jpeg",
            "https://images.pexels.com/photos/2526878/pexels-photo-2526878.jpeg"
        ]
    },
    {
        id: 10,
        title: {
            en: "Children's Theater Show",
            ar: "عرض مسرح الأطفال"
        },
        category: "family",
        date: "2025-01-20",
        time: "3:00 PM",
        location: {
            en: "Municipal Theater",
            ar: "المسرح البلدي"
        },
        image: "https://images.pexels.com/photos/1128318/pexels-photo-1128318.jpeg",
        shortDescription: {
            en: "Magical theater performance designed especially for children and families.",
            ar: "عرض مسرحي سحري مصمم خصيصاً للأطفال والعائلات."
        },
        fullDescription: {
            en: "Bring your little ones to this enchanting theater performance! Professional actors bring beloved fairy tales to life with colorful costumes, catchy songs, and interactive elements. Perfect for ages 3-12, but the whole family will enjoy this magical experience.",
            ar: "احضر أطفالك الصغار إلى هذا العرض المسرحي الساحر! يجلب الممثلون المحترفون حكايات الخيال المحبوبة إلى الحياة بأزياء ملونة وأغاني جذابة وعناصر تفاعلية. مثالي للأعمار من 3 إلى 12 سنة، لكن العائلة بأكملها ستستمتع بهذه التجربة السحرية."
        },
        price: "$12-18",
        organizer: "Children's Theater Company",
        website: "www.childrenstheater.org",
        gallery: [
            "https://images.pexels.com/photos/1128318/pexels-photo-1128318.jpeg",
            "https://images.pexels.com/photos/1720186/pexels-photo-1720186.jpeg",
            "https://images.pexels.com/photos/1497394/pexels-photo-1497394.jpeg"
        ]
    },
    {
        id: 11,
        title: {
            en: "Wine Tasting Evening",
            ar: "أمسية تذوق النبيذ"
        },
        category: "food",
        date: "2025-01-22",
        time: "6:30 PM",
        location: {
            en: "Vineyard Restaurant",
            ar: "مطعم الكرم"
        },
        image: "https://images.pexels.com/photos/958545/pexels-photo-958545.jpeg",
        shortDescription: {
            en: "Elegant wine tasting featuring local and international selections.",
            ar: "تذوق نبيذ أنيق يضم تشكيلة محلية ودولية."
        },
        fullDescription: {
            en: "Discover exceptional wines in this sophisticated tasting event. Expert sommeliers guide you through carefully selected wines paired with artisanal cheeses and appetizers. Learn about wine regions, tasting techniques, and food pairings in an intimate setting.",
            ar: "اكتشف نبيذاً استثنائياً في حدث التذوق هذا. يرشدك خبراء السقاة عبر نبيذ مختار بعناية مقترن بأجبان حرفية ومقبلات. تعلم عن مناطق النبيذ، تقنيات التذوق، واقتران الطعام في جو حميمي."
        },
        price: "$65",
        organizer: "Wine Enthusiasts Club",
        website: "www.wineenthusiasts.com",
        gallery: [
            "https://images.pexels.com/photos/958545/pexels-photo-958545.jpeg",
            "https://images.pexels.com/photos/1640777/pexels-photo-1640777.jpeg",
            "https://images.pexels.com/photos/3171837/pexels-photo-3171837.jpeg"
        ]
    },
    {
        id: 12,
        title: {
            en: "Startup Pitch Competition",
            ar: "مسابقة عرض الشركات الناشئة"
        },
        category: "business",
        date: "2025-01-25",
        time: "1:00 PM",
        location: {
            en: "Innovation Hub",
            ar: "مركز الابتكار"
        },
        image: "https://images.pexels.com/photos/3184360/pexels-photo-3184360.jpeg",
        shortDescription: {
            en: "Entrepreneurs compete for funding and mentorship opportunities.",
            ar: "يتنافس رواد الأعمال على فرص التمويل والإرشاد."
        },
        fullDescription: {
            en: "Watch innovative startups pitch their ideas to a panel of investors and industry experts. Competing companies will present their business models, market strategies, and growth plans. Networking opportunities, workshops, and prizes for winners. Great for entrepreneurs and investors alike.",
            ar: "شاهد الشركات الناشئة المبتكرة تعرض أفكارها على لجنة من المستثمرين وخبراء الصناعة. ستقدم الشركات المتنافسة نماذج أعمالها، استراتيجيات السوق، وخطط النمو. فرص التواصل، ورش العمل، وجوائز للفائزين. رائع لرواد الأعمال والمستثمرين على حد سواء."
        },
        price: "Free",
        organizer: "Entrepreneur Network",
        website: "www.entrepreneurnetwork.org",
        gallery: [
            "https://images.pexels.com/photos/3184360/pexels-photo-3184360.jpeg",
            "https://images.pexels.com/photos/1181533/pexels-photo-1181533.jpeg",
            "https://images.pexels.com/photos/2774556/pexels-photo-2774556.jpeg"
        ]
    },
    {
        id: 13,
        title: {
            en: "Classical Music Concert",
            ar: "حفل الموسيقى الكلاسيكية"
        },
        category: "music",
        date: "2025-01-28",
        time: "7:30 PM",
        location: {
            en: "Symphony Hall",
            ar: "قاعة السمفونية"
        },
        image: "https://images.pexels.com/photos/167636/pexels-photo-167636.jpeg",
        shortDescription: {
            en: "Beautiful classical music performed by the city symphony orchestra.",
            ar: "موسيقى كلاسيكية جميلة تؤديها أوركسترا المدينة السمفونية."
        },
        fullDescription: {
            en: "Experience the timeless beauty of classical music with our city symphony orchestra. This evening features masterpieces by Mozart, Beethoven, and Tchaikovsky. The program includes both beloved classics and lesser-known gems, performed by world-class musicians in our acoustically perfect symphony hall.",
            ar: "جرب الجمال الخالد للموسيقى الكلاسيكية مع أوركسترا المدينة السمفونية. تضم هذه الأمسية روائع لموتسارت، بيتهوفن، وتشايكوفسكي. يتضمن البرنامج كلاسيكيات محبوبة وقطعاً أقل شهرة، يؤديها موسيقيون من الطراز العالمي في قاعة السمفونية ذات الصوتيات المثالية."
        },
        price: "$25-85",
        organizer: "City Symphony Orchestra",
        website: "www.citysymphony.org",
        gallery: [
            "https://images.pexels.com/photos/167636/pexels-photo-167636.jpeg",
            "https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg",
            "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg"
        ]
    },
    {
        id: 14,
        title: {
            en: "Street Art Festival",
            ar: "مهرجان فن الشارع"
        },
        category: "culture",
        date: "2025-01-30",
        time: "12:00 PM",
        location: {
            en: "Arts District",
            ar: "حي الفنون"
        },
        image: "https://images.pexels.com/photos/1743227/pexels-photo-1743227.jpeg",
        shortDescription: {
            en: "Celebrate urban art with live murals, graffiti, and street performances.",
            ar: "احتفل بالفن الحضري مع جداريات حية، جرافيتي، وعروض شارع."
        },
        fullDescription: {
            en: "Immerse yourself in the vibrant world of street art! Watch talented artists create live murals, enjoy street performances, and explore interactive art installations. Food trucks, live music, and workshops for all ages. This festival celebrates the creativity and culture of urban art.",
            ar: "انغمس في عالم فن الشارع النابض بالحياة! شاهد فنانين موهوبين يخلقون جداريات حية، استمتع بعروض الشارع، واستكشف التركيبات الفنية التفاعلية. شاحنات الطعام، موسيقى حية، وورش عمل لجميع الأعمار. يحتفل هذا المهرجان بالإبداع والثقافة في الفن الحضري."
        },
        price: "Free",
        organizer: "Urban Arts Collective",
        website: "www.urbanartscollective.com",
        gallery: [
            "https://images.pexels.com/photos/1743227/pexels-photo-1743227.jpeg",
            "https://images.pexels.com/photos/1183992/pexels-photo-1183992.jpeg",
            "https://images.pexels.com/photos/1105666/pexels-photo-1105666.jpeg"
        ]
    },
    {
        id: 15,
        title: {
            en: "Cycling Challenge",
            ar: "تحدي ركوب الدراجات"
        },
        category: "sports",
        date: "2025-02-02",
        time: "8:00 AM",
        location: {
            en: "Lakeside Trail",
            ar: "مسار البحيرة"
        },
        image: "https://images.pexels.com/photos/3764984/pexels-photo-3764984.jpeg",
        shortDescription: {
            en: "Scenic cycling event with multiple route options for all fitness levels.",
            ar: "حدث ركوب دراجات خلاب بمسار متعدد الخيارات لجميع مستويات اللياقة."
        },
        fullDescription: {
            en: "Join fellow cycling enthusiasts for a scenic ride around our beautiful lakeside trail. Multiple route options: 10km family ride, 25km recreational route, and 50km challenge course. Registration includes event jersey, refreshments, and post-ride celebration. Bike rentals available.",
            ar: "انضم لعشاق ركوب الدراجات في رحلة خلابة حول مسار البحيرة الجميل. خيارات مسار متعددة: رحلة عائلية 10 كم، مسار ترفيهي 25 كم، ومسار تحدي 50 كم. التسجيل يشمل قميص الحدث، المشروبات، واحتفال ما بعد الرحلة. تتوفر دراجات للإيجار."
        },
        price: "$20-35",
        organizer: "Cycling Club United",
        website: "www.cyclingclubunited.com",
        gallery: [
            "https://images.pexels.com/photos/3764984/pexels-photo-3764984.jpeg",
            "https://images.pexels.com/photos/2526878/pexels-photo-2526878.jpeg",
            "https://images.pexels.com/photos/2402777/pexels-photo-2402777.jpeg"
        ]
    }
];

// DOM elements
let allEvents = [...eventsData];
let currentEvent = null;

// Dark mode functionality (keep your existing dark mode code)
function initializeDarkMode() {
    const darkModeToggle = document.getElementById('darkModeToggle');
    const currentTheme = localStorage.getItem('theme') || 'light';
    
    document.documentElement.setAttribute('data-theme', currentTheme);
    updateDarkModeButton(currentTheme);
    
    if (darkModeToggle) {
        darkModeToggle.addEventListener('click', toggleDarkMode);
    }
}

function toggleDarkMode() {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    updateDarkModeButton(newTheme);
}

function updateDarkModeButton(theme) {
    const darkModeToggle = document.getElementById('darkModeToggle');
    if (darkModeToggle) {
        const icon = darkModeToggle.querySelector('i');
        if (theme === 'dark') {
            icon.className = 'fas fa-sun';
        } else {
            icon.className = 'fas fa-moon';
        }
    }
}

// Event rendering functions with language support
function createEventCard(event, showDetails = true) {
 const title = getEventText(event, 'title');
    const shortDescription = getEventText(event, 'shortDescription');
    const location = getEventText(event, 'location');
     return `
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card event-card h-100" ${showDetails ? `onclick="goToEventDetails(${event.id})"` : ''}>
                <img src="${event.image}" class="card-img-top" alt="${title}">
                <div class="card-body d-flex flex-column">
                    <span class="badge bg-primary mb-2 align-self-start">${getCategoryName(event.category)}</span>
                    <h5 class="card-title">${title}</h5>
                    <p class="card-text flex-grow-1">${shortDescription}</p>
                    <div class="mt-auto">
                        <small class="text-muted">
                            <i class="fas fa-calendar me-1"></i>${formatDate(event.date)}
                            <i class="fas fa-clock ms-3 me-1"></i>${event.time}
                        </small>
                        <br>
                        <small class="text-muted">
                            <i class="fas fa-map-marker-alt me-1"></i>${location}
                        </small>
                        ${showDetails ? `
                        <div class="mt-2">
                            <button class="btn btn-outline-primary btn-sm" data-i18n="home.view_details">View Details</button>
                        </div>
                        ` : ''}
                    </div>
                </div>
            </div>
        </div>
    `;
}

function getCategoryName(category) {
    return translations[currentLanguage][`category.${category}`] || category.toUpperCase();
}


function formatDate(dateString) {
    const options = { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
    };
    return new Date(dateString).toLocaleDateString(currentLanguage === 'ar' ? 'ar-EG' : 'en-US', options);
}

// Page-specific initialization
function initializePage() {
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    
    switch (currentPage) {
        case 'index.html':
        case '':
            initializeHomePage();
            break;
        case 'events.html':
            initializeEventsPage();
            break;
        case 'event.html':
            initializeEventDetailsPage();
            break;
        case 'contact.html':
            initializeContactPage();
            break;
    }
}

// Home page initialization
function initializeHomePage() {
    loadHeroCarousel();
    loadTopEventsCarousel();
    loadCategories();
    loadLatestEvents();
}

// Load hero carousel with language support
function loadHeroCarousel() {
    const heroContainer = document.getElementById('heroCarousel');
    if (!heroContainer) return;
    
    const indicators = heroSlides.map((_, index) => 
        `<button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="${index}" ${index === 0 ? 'class="active"' : ''}></button>`
    ).join('');
    
    const slides = heroSlides.map((slide, index) => {
        const title = slide.title[currentLanguage] || slide.title;
        const description = slide.description[currentLanguage] || slide.description;
        const buttonText = slide.buttonText[currentLanguage] || slide.buttonText;
        const alt = slide.alt[currentLanguage] || slide.alt;

        return `
            <div class="carousel-item ${index === 0 ? 'active' : ''}">
                <div class="row align-items-center">
                    <div class="col-lg-6">
                        <h1 class="display-4 fw-bold mb-4">${title}</h1>
                        <p class="lead mb-4">${description}</p>
                        <a href="${slide.buttonLink}" class="btn btn-secondary btn-lg">${buttonText}</a>
                    </div>
                    <div class="col-lg-6">
                        <img src="${slide.image}" class="img-fluid rounded shadow hero-image" alt="${alt}">
                    </div>
                </div>
            </div>
        `;
    }).join('');
    
    heroContainer.innerHTML = `
        <div class="carousel slide" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-indicators">
                ${indicators}
            </div>
            <div class="carousel-inner">
                ${slides}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel .carousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel .carousel" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    `;
}

// Load top events carousel
function loadTopEventsCarousel() {
    const eventsContainer = document.getElementById('eventsCarousel');
    if (!eventsContainer) return;
    
    const topEvents = allEvents.slice(0, 9);
    const eventsPerSlide = 3;
    const totalSlides = Math.ceil(topEvents.length / eventsPerSlide);
    
    const indicators = Array.from({length: totalSlides}, (_, index) => 
        `<button type="button" data-bs-target="#topEventsCarousel" data-bs-slide-to="${index}" ${index === 0 ? 'class="active"' : ''}></button>`
    ).join('');
    
    const slides = [];
    for (let i = 0; i < totalSlides; i++) {
        const slideEvents = topEvents.slice(i * eventsPerSlide, (i + 1) * eventsPerSlide);
        const slideCards = slideEvents.map(event => createEventCard(event)).join('');
        
        slides.push(`
            <div class="carousel-item ${i === 0 ? 'active' : ''}">
                <div class="row">
                    ${slideCards}
                </div>
            </div>
        `);
    }
    
    eventsContainer.innerHTML = `
        <div id="topEventsCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
            <div class="carousel-indicators">
                ${indicators}
            </div>
            <div class="carousel-inner">
                ${slides.join('')}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#topEventsCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#topEventsCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    `;
    
    // Re-apply translations
    setTimeout(() => applyLanguage(), 100);
}

// Load categories with language support
function loadCategories() {
    const categoriesContainer = document.getElementById('categoriesContainer');
    if (!categoriesContainer) return;
    
    const categoryButtons = categories.map(category => {
        const name = category.name[currentLanguage] || category.name;
        return `
            <div class="col-6 col-md-4 col-lg-2 mb-4">
                <a href="${category.link}" class="category-btn">
                    <div class="category-icon mb-3">
                        <i class="${category.icon}"></i>
                    </div>
                    <h5>${name}</h5>
                </a>
            </div>
        `;
    }).join('');
    
    categoriesContainer.innerHTML = categoryButtons;
}

function loadLatestEvents() {
    const latestEventsContainer = document.getElementById('latestEvents');
    if (latestEventsContainer) {
        const latestEvents = allEvents.slice(0, 6);
        latestEventsContainer.innerHTML = latestEvents.map(event => createEventCard(event)).join('');
        
        // Re-apply translations
        setTimeout(() => applyLanguage(), 100);
    }
}
// Events page initialization
function initializeEventsPage() {
    loadAllEvents();
    initializeFilters();
    handleURLParameters();
}

function loadAllEvents() {
    const eventsContainer = document.getElementById('eventsContainer');
    if (eventsContainer) {
        renderEvents(allEvents);
    }
}

function renderEvents(events) {
    const eventsContainer = document.getElementById('eventsContainer');
    const noEventsMessage = document.getElementById('noEvents');
    
    if (events.length === 0) {
        eventsContainer.innerHTML = '';
        if (noEventsMessage) {
            noEventsMessage.style.display = 'block';
            noEventsMessage.innerHTML = `
                <h4 data-i18n="events.no_events">No events found</h4>
                <p data-i18n="events.no_events_desc">Try adjusting your search or filter criteria.</p>
            `;
            applyLanguage();
        }
    } else {
        eventsContainer.innerHTML = events.map(event => createEventCard(event)).join('');
        if (noEventsMessage) noEventsMessage.style.display = 'none';
        
        // Re-apply translations
        setTimeout(() => applyLanguage(), 100);
    }
}

function initializeFilters() {
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const dateFilter = document.getElementById('dateFilter');
    const clearFilters = document.getElementById('clearFilters');
    
    if (searchInput) {
        searchInput.addEventListener('input', filterEvents);
    }
    if (categoryFilter) {
        categoryFilter.addEventListener('change', filterEvents);
    }
    if (dateFilter) {
        dateFilter.addEventListener('change', filterEvents);
    }
    if (clearFilters) {
        clearFilters.addEventListener('click', clearAllFilters);
    }
}

function filterEvents() {
    const searchTerm = document.getElementById('searchInput')?.value.toLowerCase() || '';
    const selectedCategory = document.getElementById('categoryFilter')?.value || '';
    const selectedDate = document.getElementById('dateFilter')?.value || '';
    
    let filteredEvents = allEvents.filter(event => {
        const title = event.title[currentLanguage] || event.title;
        const shortDescription = event.shortDescription[currentLanguage] || event.shortDescription;
        const location = event.location[currentLanguage] || event.location;
        
        const matchesSearch = title.toLowerCase().includes(searchTerm) ||
                             shortDescription.toLowerCase().includes(searchTerm) ||
                             location.toLowerCase().includes(searchTerm);
        const matchesCategory = !selectedCategory || event.category === selectedCategory;
        const matchesDate = !selectedDate || event.date === selectedDate;
        
        return matchesSearch && matchesCategory && matchesDate;
    });
    
    renderEvents(filteredEvents);
}

function clearAllFilters() {
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const dateFilter = document.getElementById('dateFilter');
    
    if (searchInput) searchInput.value = '';
    if (categoryFilter) categoryFilter.value = '';
    if (dateFilter) dateFilter.value = '';
    
    renderEvents(allEvents);
}

function handleURLParameters() {
    const urlParams = new URLSearchParams(window.location.search);
    const category = urlParams.get('category');
    
    if (category) {
        const categoryFilter = document.getElementById('categoryFilter');
        if (categoryFilter) {
            categoryFilter.value = category;
            filterEvents();
        }
    }
}

// Event details page with language support
function initializeEventDetailsPage() {
    const urlParams = new URLSearchParams(window.location.search);
    const eventId = parseInt(urlParams.get('id'));
    
    if (eventId) {
        currentEvent = allEvents.find(event => event.id === eventId);
        if (currentEvent) {
            renderEventDetails(currentEvent);
            loadRelatedEvents(currentEvent);
        }
    }
    
    initializeEventActions();
}

function renderEventDetails(event) {
    console.log('Rendering event details for:', event);
    
    const title = getEventText(event, 'title');
    const fullDescription = getEventText(event, 'fullDescription');
    const location = getEventText(event, 'location');

    // Event header
    const eventHeader = document.getElementById('eventHeader');
    if (eventHeader) {
        eventHeader.innerHTML = `
            <h1 class="display-5 fw-bold mb-3">${title}</h1>
            <div class="d-flex flex-wrap gap-3 mb-4">
                <span class="badge bg-primary fs-6">${getCategoryName(event.category)}</span>
                <span class="text-muted">
                    <i class="fas fa-calendar me-1"></i>${formatDate(event.date)}
                </span>
                <span class="text-muted">
                    <i class="fas fa-clock me-1"></i>${event.time}
                </span>
                <span class="text-muted">
                    <i class="fas fa-map-marker-alt me-1"></i>${location}
                </span>
            </div>
            <img src="${event.image}" class="img-fluid rounded shadow mb-4" alt="${title}">
        `;
    }
    
    // Event info card
    const eventInfo = document.getElementById('eventInfo');
    if (eventInfo) {
        eventInfo.innerHTML = `
            <div class="info-item mb-3">
                <strong data-i18n="event.date">Date:</strong><br>
                <span class="text-muted">${formatDate(event.date)} ${translations[currentLanguage]['general.at'] || 'at'} ${event.time}</span>
            </div>
            <div class="info-item mb-3">
                <strong data-i18n="event.location">Location:</strong><br>
                <span class="text-muted">${location}</span>
            </div>
            <div class="info-item mb-3">
                <strong data-i18n="event.price">Price:</strong><br>
                <span class="text-muted">${event.price}</span>
            </div>
            <div class="info-item mb-3">
                <strong data-i18n="event.organizer">Organizer:</strong><br>
                <span class="text-muted">${event.organizer}</span>
            </div>
            <div class="info-item">
                <strong data-i18n="event.website">Website:</strong><br>
                <a href="https://${event.website}" target="_blank" class="text-primary">${event.website}</a>
            </div>
        `;
    }
    
    // Event description
    const eventDescription = document.getElementById('eventDescription');
    if (eventDescription) {
        eventDescription.innerHTML = `<p class="lead">${fullDescription}</p>`;
    }
    
    // Event gallery
    const eventGallery = document.getElementById('eventGallery');
    if (eventGallery && event.gallery) {
        eventGallery.innerHTML = event.gallery.map((image, index) => `
            <div class="col-md-4 mb-3">
                <img src="${image}" class="img-fluid rounded shadow" alt="${title} - ${index + 1}">
            </div>
        `).join('');
    }

    // Apply translations to the newly added elements
    setTimeout(() => applyLanguage(), 100);
}

function loadRelatedEvents(currentEvent) {
    const relatedEventsContainer = document.getElementById('relatedEvents');
    if (relatedEventsContainer) {
        const relatedEvents = allEvents
            .filter(event => event.id !== currentEvent.id && event.category === currentEvent.category)
            .slice(0, 3);
        
        relatedEventsContainer.innerHTML = relatedEvents.map(event => createEventCard(event)).join('');
        
        // Re-apply translations
        setTimeout(() => applyLanguage(), 100);
    }
}

function initializeEventActions() {
    const addToCalendarBtn = document.getElementById('addToCalendar');
    const shareEventBtn = document.getElementById('shareEvent');
    
    if (addToCalendarBtn) {
        addToCalendarBtn.addEventListener('click', addToCalendar);
    }
    if (shareEventBtn) {
        shareEventBtn.addEventListener('click', showShareModal);
    }
}

function addToCalendar() {
    if (currentEvent) {
        const startDate = new Date(`${currentEvent.date}T${convertTo24Hour(currentEvent.time)}`);
        const endDate = new Date(startDate.getTime() + 2 * 60 * 60 * 1000);
        
        const calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(currentEvent.title[currentLanguage] || currentEvent.title)}&dates=${formatDateForCalendar(startDate)}/${formatDateForCalendar(endDate)}&details=${encodeURIComponent(currentEvent.fullDescription[currentLanguage] || currentEvent.fullDescription)}&location=${encodeURIComponent(currentEvent.location[currentLanguage] || currentEvent.location)}`;
        
        window.open(calendarUrl, '_blank');
    }
}

function convertTo24Hour(time12h) {
    const [time, modifier] = time12h.split(' ');
    let [hours, minutes] = time.split(':');
    if (hours === '12') {
        hours = '00';
    }
    if (modifier === 'PM') {
        hours = parseInt(hours, 10) + 12;
    }
    return `${hours.toString().padStart(2, '0')}:${minutes}:00`;
}

function formatDateForCalendar(date) {
    return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
}

function showShareModal() {
    const shareModal = new bootstrap.Modal(document.getElementById('shareModal'));
    shareModal.show();
}

// Share functions
function shareOnFacebook() {
    const url = encodeURIComponent(window.location.href);
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
}
function goToEventDetails(eventId) {
    window.location.href = `event.html?id=${eventId}`;
}
function shareOnTwitter() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent(currentEvent ? (currentEvent.title[currentLanguage] || currentEvent.title) : 'Check out this event!');
    window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank');
}

function shareOnWhatsApp() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent(currentEvent ? `${translations[currentLanguage]['event.share_text'] || 'Check out this event:'} ${currentEvent.title[currentLanguage] || currentEvent.title}` : 'Check out this event!');
    window.open(`https://wa.me/?text=${text} ${url}`, '_blank');
}

// Contact page functionality
function initializeContactPage() {
    const contactForm = document.getElementById('contactForm');
    if (contactForm) {
        contactForm.addEventListener('submit', handleContactFormSubmit);
    }
}

function handleContactFormSubmit(e) {
    e.preventDefault();
    
    // Clear previous alerts
    const alertContainer = document.getElementById('alertContainer');
    alertContainer.innerHTML = '';
    
    // Get form data
    const formData = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName: document.getElementById('lastName').value.trim(),
        email: document.getElementById('email').value.trim(),
        subject: document.getElementById('subject').value,
        message: document.getElementById('message').value.trim()
    };
    
    // Validate form
    const validation = validateContactForm(formData);
    
    if (validation.isValid) {
        // Simulate form submission
        showAlert('success', 'Thank you for your message! We will get back to you within 24 hours.');
        document.getElementById('contactForm').reset();
        removeValidationClasses();
    } else {
        showAlert('danger', 'Please correct the errors below and try again.');
        showValidationErrors(validation.errors);
    }
}

function validateContactForm(data) {
    const errors = {};
    let isValid = true;
    
    // Validate first name
    if (!data.firstName) {
        errors.firstName = 'First name is required.';
        isValid = false;
    }
    
    // Validate last name
    if (!data.lastName) {
        errors.lastName = 'Last name is required.';
        isValid = false;
    }
    
    // Validate email
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!data.email) {
        errors.email = 'Email is required.';
        isValid = false;
    } else if (!emailRegex.test(data.email)) {
        errors.email = 'Please enter a valid email address.';
        isValid = false;
    }
    
    // Validate subject
    if (!data.subject) {
        errors.subject = 'Please select a subject.';
        isValid = false;
    }
    
    // Validate message
    if (!data.message) {
        errors.message = 'Message is required.';
        isValid = false;
    } else if (data.message.length < 10) {
        errors.message = 'Message must be at least 10 characters long.';
        isValid = false;
    }
    
    return { isValid, errors };
}

function showValidationErrors(errors) {
    Object.keys(errors).forEach(field => {
        const input = document.getElementById(field);
        const feedback = input.nextElementSibling;
        
        input.classList.add('is-invalid');
        if (feedback && feedback.classList.contains('invalid-feedback')) {
            feedback.textContent = errors[field];
        }
    });
}

function removeValidationClasses() {
    const inputs = ['firstName', 'lastName', 'email', 'subject', 'message'];
    inputs.forEach(inputId => {
        const input = document.getElementById(inputId);
        if (input) {
            input.classList.remove('is-invalid', 'is-valid');
        }
    });
}

function showAlert(type, message) {
    const alertContainer = document.getElementById('alertContainer');
    const alertHtml = `
        <div class="alert alert-${type} alert-dismissible fade show" role="alert">
            <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'} me-2"></i>
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    `;
    alertContainer.innerHTML = alertHtml;
    
    // Auto dismiss success alerts after 5 seconds
    if (type === 'success') {
        setTimeout(() => {
            const alert = alertContainer.querySelector('.alert');
            if (alert) {
                const bsAlert = new bootstrap.Alert(alert);
                bsAlert.close();
            }
        }, 5000);
    }
}

// Navigation function
function goToEventDetails(eventId) {
    // Store the current language in the URL so the new page loads with the correct language
    const lang = currentLanguage;
    window.location.href = `event.html?id=${eventId}&lang=${lang}`;
}

// Initialize everything when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
      const urlParams = new URLSearchParams(window.location.search);
    const urlLang = urlParams.get('lang');
    if (urlLang && (urlLang === 'en' || urlLang === 'ar')) {
        console.log('Language from URL:', urlLang);
        currentLanguage = urlLang;
        localStorage.setItem('language', urlLang);
    }
    initializeDarkMode();
    initializeLanguage(); // Initialize language first
    initializePage();
    
    // Add smooth scrolling to all anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        });
    });
    
    // Add fade-in animation to cards
    const cards = document.querySelectorAll('.card');
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const cardObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('fade-in-up');
            }
        });
    }, observerOptions);
    
    cards.forEach(card => {
        cardObserver.observe(card);
    });
});
function getEventText(event, property) {
    if (typeof event[property] === 'object') {
        return event[property][currentLanguage] || event[property].en;
    }
    return event[property];
}
// Add this to translations for Arabic
translations.ar['event.at'] = 'في';
translations.ar['event.share_text'] = 'اطلع على هذه الفعالية:';